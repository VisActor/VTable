---
заголовок: 4.2 событие списокening    

key words: VisActor,Vграфик,Vтаблица,VStrory,VMind,VGrammar,VRender,Visualization,график,данные,таблица,Graph,Gis,LLM
---
## Introduction


The событие module serves as the entry module для interactive functions в the Vтаблица, primarily списокening к two parts из событиеs:    

1. списокening к external событиеs, событиеs related к the scene tree.    

1. списокening к native DOM событиеs.    

This article will analyze от the above two perspectives, explaining which событиеs the Vтаблица specifically списокens к.    \r

## списокening Closure


Most из the событие списокening is done в the `событиеManвозрастr` module, с the main entry point located в `bindOuterсобытие`. следующий, we will analyze the событие списокening part в the Vтаблица through this функция.    

```Typescript
// packвозрастs\vтаблица\src\событие\событие.ts
export class событиеManвозрастr {
// ...
  bindOuterсобытие() {
    bindтаблицаGroupсписокener(this);
    bindContainerDomсписокener(this);
    bindScrollBarсписокener(this);
    bindTouchсписокener(this);
    bindGesture(this);
  }
}    

```
`bindOuterсобытие` is divided into five parts:    

* bindтаблицаGroupсписокener: Mainly списокens к external событиеs, scene tree related событиеs;    \r

*  bindContainerDomсписокener: списокen к native DOM событиеs;    \r

* bindScrollBarсписокener: списокen к external scrollbar событиеs;    \r

* bindTouchсписокener: списокen к touch событиеs на mobile devices, internally списокening к both native DOM и external событиеs;    \r

* bindGesture: списокen для double-Нажать событиеs и trigger пользовательский событиеs related к double-Нажатьing;    \r

Следующий will provide a detailed analysis из these modules.    

## DOM Related событиеs


### таблица Container


`bindContainerDomсписокener` is responsible для списокening к native DOM событиеs internally, mainly списокening к Следующий two objects.    

#### document related 

<img src='https://cdn.jsdelivr.net/gh/xuanhun/articles/visactor/sourceкод/img/TQlVbfkwJoaVcjxj8rRcDLD5n7f.gif' alt='' ширина='1000' высота='авто'>

#### таблица Container

<img src='https://cdn.jsdelivr.net/gh/xuanhun/articles/visactor/sourceкод/img/SJXPbVJ6OosUU3xYmFHcC6Z7nJe.gif' alt='' ширина='1000' высота='авто'>

#### Source код

*  bindContainerDomсписокener    

```xml
// vтаблица\src\событие\списокener\container-dom.ts
// 容器级事件
handler.на(таблица.getElement(), 'потеря фокуса', ...);       // 失去焦点
handler.на(таблица.getElement(), 'keydown', ...);     // 键盘事件（快捷键）
handler.на(таблица.getElement(), 'copy', ...);        // 复制操作
handler.на(таблица.getElement(), 'paste', ...);       // 粘贴操作
handler.на(таблица.getElement(), 'contextменю', ...); // 右键菜单
// 全局指针事件
document.body.addсобытиесписокener('pointerdown', ...);   // 全局按下
document.addсобытиесписокener('pointerup', ...);          // 全局释放 
document.body.addсобытиесписокener('pointermove', ...);   // 全局移动
// 容器尺寸变化
handler.на(таблица.getContainer(), 'изменение размера', ...);     // 容器resize    

```
### Mobile событиеs


*  bindTouchсписокener    

`bindTouchсписокener` списокens к mobile событиеs, mainly к support the таблица movement feature на mobile devices.    

<img src='https://cdn.jsdelivr.net/gh/xuanhun/articles/visactor/sourceкод/img/MwKPbYOhlo9TlnxazQUcW4s5nzs.gif' alt='' ширина='668' высота='авто'>

*  Source код    

```Typescript
// packвозрастs\vтаблица\src\событие\списокener\touch.ts
window.addсобытиесписокener('touchmove', (e) => {    // 触摸移动
    // 1. 阻止默认滚动行为
    // 2. 计算滑动距离（deltaX/deltaY）
    // 3. 调用handleWhell实现表格内容滚动
});

window.addсобытиесписокener('touchend', (e) => {      // 触摸结束
    // 触发惯性滚动
});

window.addсобытиесписокener('touchотмена', (e) => {
    // 清空移动端 touch 事件相关参数
});    

```
## Scene Tree Related


### базовый событиеs из Scene Tree

The scene tree is divided into three parts для списокening, which will be explained below:    \r

#### таблицаGroup 

The таблица overall Group container is related, mainly к списокen к событиеs provided по VRender;    \r

<img src='https://cdn.jsdelivr.net/gh/xuanhun/articles/visactor/sourceкод/img/NRAVbWUdlo3lAPxpQjecFGAHnbf.gif' alt='' ширина='1000' высота='авто'>

#### stвозраст событие


<img src='https://cdn.jsdelivr.net/gh/xuanhun/articles/visactor/sourceкод/img/R93yb6CmaoLmAhxr5mycBGQQn0e.gif' alt='' ширина='974' высота='авто'>

#### Global событиеs


<img src='https://cdn.jsdelivr.net/gh/xuanhun/articles/visactor/sourceкод/img/Ahc0bAi4DхорошоixyxJz2JcTaubnYe.gif' alt='' ширина='717' высота='авто'>

#### Source код

*  bindтаблицаGroupсписокener    

```javascript
// packвозрастs\vтаблица\src\событие\списокener\таблица-group.ts
// 表格组基础事件
таблица.scenegraph.таблицаGroup.addсобытиесписокener('pointermove', ...); // 指针移动
таблица.scenegraph.таблицаGroup.addсобытиесписокener('pointerdown', ...); // 指针按下
таблица.scenegraph.таблицаGroup.addсобытиесписокener('pointerup', ...);   // 指针释放
таблица.scenegraph.таблицаGroup.addсобытиесписокener('pointerover', ...);   // 指针进入区域内部
таблица.scenegraph.таблицаGroup.addсобытиесписокener('pointerenter', ...);   // 指针穿过区域边界
таблица.scenegraph.таблицаGroup.addсобытиесписокener('pointerleave', ...);   // 指针离开区域
таблица.scenegraph.таблицаGroup.addсобытиесписокener('pointertap', ...);   // 指针点击
таблица.scenegraph.таблицаGroup.addсобытиесписокener('rightdown', ...);   // 右键点击
таблица.scenegraph.таблицаGroup.addсобытиесписокener('wheel', ...);       // 滚轮事件
таблица.scenegraph.таблицаGroup.addсобытиесписокener('checkbox_state_change', ...); // 多选框状态改变
таблица.scenegraph.таблицаGroup.addсобытиесписокener('radio_checked', ...); // 单选框状态改变

// stвозраст 相关
таблица.scenegraph.stвозраст.addсобытиесписокener('pointerdown', ...);
таблица.scenegraph.stвозраст.addсобытиесписокener('pointerup', ...);
таблица.scenegraph.stвозраст.addсобытиесписокener('pointertap', ...);
таблица.scenegraph.stвозраст.addсобытиесписокener('pointermove', ...);

// vglobal
vglobal.addсобытиесписокener('pointerup', globalPointerupCallback);
vglobal.addсобытиесписокener('pointerdown', globalPointerdownCallback);    

```
### Scrollbar Related событиеs


`bindScrollBarсписокener` списокens к the событиеs provided по the `ScrollBar` компонент из VRender.    

Vтаблица has two types из прокрутка bars, имяly the horizontal прокрутка bar `hScrollBar` и the vertical прокрутка bar `vScrollBar`. The событие types списокened к по these two прокрутка bars are the same. Taking the vertical прокрутка bar as an пример, it mainly списокens к Следующий событиеs:

*  pointerover    

*  pointerout    

*  pointerup    

*  pointermove    

*  pointerupoutside    

*  scrollDown    

*  scrollDrag    

*  scrollUp    

---
*  `bindScrollBarсписокener`    

```Typescript
// packвозрастs\vтаблица\src\событие\списокener\прокрутка-bar.ts
// 垂直滚动条事件
scenegraph.компонент.vScrollBar.addсобытиесписокener('pointerover', (e) => {  // 指针悬停
    stateManвозрастr.showVerticalScrollBar(); // 显示滚动条
});
scenegraph.компонент.vScrollBar.addсобытиесписокener('pointerout', (e) => {   // 鼠标移出
    stateManвозрастr.hideVerticalScrollBar(); // 隐藏滚动条
});
scenegraph.компонент.vScrollBar.addсобытиесписокener('pointerdown', (e) => { // 鼠标按下
    // 1. 阻止事件冒泡
    // 2. 触发MOUSEDOWN_таблица事件
});
// 滚动条拖动事件
scenegraph.компонент.vScrollBar.addсобытиесписокener('scrollDrag', ((e) => {
    // 1. 同步表格滚动位置
    // 2. 更新画布渲染
}));
scenegraph.компонент.vScrollBar.addсобытиесписокener('scrollDown', (e) => {
    // 点击滚动条，更新滚动状态
});
// 鼠标从滚动条上抬起事件，清除滚动状态
scenegraph.компонент.vScrollBar.addсобытиесписокener('scrollUp', (e:) => {})    

```
### Mobile событиеs


`bindTouchсписокener` separately регистрацияs a `touchstart` обратный вызов для `таблицаGroup` к initialize touch information на mobile devices.

```Typescript
// packвозрастs\vтаблица\src\событие\списокener\touch.ts
// 基础触摸事件
таблица.scenegraph.таблицаGroup.addсобытиесписокener('touchstart', (e: FederatedPointerсобытие) => {
    // 记录触摸点坐标和时间戳
    событиеManвозрастr.touchMovePoints.push({...});
});
    

```
## Conclusion


Vтаблица has a very complex interaction system, и the most important module that these interactions rely на is the событие module. в the событие module, dozens из событиеs are списокened к, including пользовательский событиеs и external событиеs.    

It is precisely because Vтаблица has such a robust событие списокening feature that it can achieve so many smooth interactions.    \r

# This document is provided по Следующий personnel


taiiiyang（https://github.com/taiiiyang）    

# This document was revised и organized по Следующий personnel 
 [玄魂](https://github.com/xuanhun)