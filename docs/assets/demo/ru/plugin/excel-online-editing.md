--- категория: примеры группа: плагин заголовок: Excel-like Online Editing обложка: https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/втаблица/preview/excel-online-editing.gif ссылка: плагин/использование опция: plugins --- # Excel-like Online Editing Based на втаблица's плагин mechanism, this пример implements Excel-like online editing функциональность. в this пример, we использовать Следующий plugins в combination: - `AddRowColumnPlugin`: Add rows и колонки - `PastedAddRowColumnPlugin`: Add новый rows или колонки when there are не enough rows или колонки when pasting - `ColumnSeriesPlugin`: колонка серия плагин - `RowSeriesPlugin`: строка серия плагин - `HighlightHeaderWhenSelectCellPlugin`: Highlight selected cells - `ExcelEditCellKeyboardPlugin`: Excel-стиль ячейка editing keyboard плагин It's important к обратите внимание, что there are dependencies between plugins. для пример, в the `AddRowColumnPlugin`, we call the `columnSeries.resetColumnCount` method к reset the колонка count, ensuring that after adding колонки, the count remains согласующийся с the колонка count в the `ColumnSeriesPlugin`. ## ключевая конфигурация - `editCellTrigger`: ячейка editing trigger method - `редактор`: редактор тип - `plugins`: плагин список ## код демонстрация ```javascript живаядемонстрация шаблон=втаблица // импорт * as втаблица от '@visactor/втаблица'; // 使用时需要引入插件包@visactor/втаблица-plugins // импорт * as втаблицаPlugins от '@visactor/втаблица-plugins'; // 正常使用方式 const columnSeries = новый втаблица.plugins.ColumnSeriesPlugin({}); // 官网编辑器中将 втаблица.plugins重命名成了втаблицаPlugins // 注册编辑器 const input_editor = новый втаблица_editors.InputEditor(); втаблица.регистрация.редактор('ввод', input_editor); // 注册插件 const addRowColumn = новый втаблицаPlugins.AddRowColumnPlugin({ addColumnCallback: колонка => { // 新增列时，重置列数 columnSeries.resetColumnCount(columnSeries.pluginOptions.columnCount + 1); // 将таблица实例中的数据源records每一个数组中新增一个空字符串，对应新增的列 const newRecords = таблицаInstance.records.map(запись => { if (массив.isArray(запись)) { запись.splice(колонка - 1, 0, ''); } возврат запись; }); таблицаInstance.setRecords(newRecords); }, addRowCallback: строка => { // 新增行时，填充空行数据 таблицаInstance.addRecord([], строка - таблицаInstance.columnHeaderLevelCount); } }); const columnSeries = новый втаблицаPlugins.ColumnSeriesPlugin({ columnCount: 26 }); const rowSeries = новый втаблицаPlugins.RowSeriesPlugin({ rowCount: 100, //records数据以外 填充空行数据 fillRowRecord: (index) => { возврат []; }, rowSeriesNumber: { ширина: 'авто' } }); const highlightPlugin = новый втаблицаPlugins.HighlightHeaderWhenSelectCellPlugin({ colHighlight: true, rowHighlight: true }); const excelEditCellKeyboardPlugin = новый втаблицаPlugins.ExcelEditCellKeyboardPlugin(); const опция = { // 二维数组的数据 和excel的行列一致 records: [ ['姓名', '年龄', '地址'], ['张三', 18, '北京'], ['李四', 20, '上海'], ['王五', 22, '广州'], ['赵六', 24, '深圳'], ['孙七', 26, '成都'] ], заполнение: 30, редактор: 'ввод', editCellTrigger: ['апи', 'keydown', 'doubleНажать'],// 编辑单元格触发方式 выбрать: { cornerHeaderSelectMode: 'body', headerSelectMode: 'body' }, тема: втаблица.темаs.по умолчанию.extends({ defaultStyle: { textAlign: 'лево', заполнение: [2, 6, 2, 6] }, headerStyle: { textAlign: 'центр' } }), defaultRowвысота: 30, plugins: [addRowColumn, columnSeries, rowSeries, highlightPlugin, excelEditCellKeyboardPlugin] }; const таблицаInstance = новый втаблица.списоктаблица( документ.getElementById(CONTAINER_ID),опция); window.таблицаInstance = таблицаInstance; ```