--- категория: примеры группа: гантт заголовок: гантт Task Hour Unit обложка: https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/втаблица/гантт/гантт-hour.png ссылка: гантт/introduction опция: гантт#timelineHeader.scales --- # гантт Task Hour Unit Support конфигурация из time scale unit('day' | 'week' | 'month' | 'quarter' | 'year' | 'hour' | 'minute' | 'second') ## ключевая конфигурация - `гантт` - `гантт#timelineHeader.scales` ## код демонстрация ```javascript живаядемонстрация шаблон=втаблица // импорт * as втаблицагантт от '@visactor/втаблица-гантт'; // импорт { втаблица } от '@visactor/втаблица-гантт'; let ганттInstance; const flag = `<svg ширина="24" высота="24" viewBox="0 0 24 24" заполнить="#e16531" xmlns="http://www.w3.org/2000/svg"> <path d="M5 15h15.415a1.5 1.5 0 0 0 1.303-2.244l-2.434-4.26a1 1 0 0 1 0-.992l2.434-4.26A1.5 1.5 0 0 0 20.415 1H5a2 2 0 0 0-2 2v19a1 1 0 0 0 2 .003V15Z" заполнить="#e16531"/> </svg> `; const report = `<svg ширина="24" высота="24" viewBox="0 0 24 24" заполнить="#FFD43C" xmlns="http://www.w3.org/2000/svg"> <path d="M13.732 2c-.77-1.333-2.694-1.333-3.464 0L.742 19c-.77 1.334.192 3 1.732 3h19.052c1.54 0 2.502-1.666 1.733-3L13.732 2ZM10.75 8.25a.75.75 0 0 1 .75-.75h1a.75.75 0 0 1 .75.75v6a.75.75 0 0 1-.75.75h-1a.75.75 0 0 1-.75-.75v-6Zm0 8.5a.75.75 0 0 1 .75-.75h1a.75.75 0 0 1 .75.75v1a.75.75 0 0 1-.75.75h-1a.75.75 0 0 1-.75-.75v-1Z" заполнить="#FFD43C"/> </svg> `; const flagиконка = { тип: 'svg', svg: flag, ширина: 20, высота: 20, имя: 'flag', positionType: втаблица.TYPES.иконкаPosition.лево, cursor: 'pointer' }; const reportиконка = { тип: 'svg', svg: report, ширина: 20, высота: 20, имя: 'report', positionType: втаблица.TYPES.иконкаPosition.лево, cursor: 'pointer' }; втаблица.регистрация.иконка('flag', flagиконка); втаблица.регистрация.иконка('report', reportиконка); const всплывающее окно = документ.createElement('div'); объект.assign(всплывающее окно.стиль, { позиция: 'fixed', ширина: '300px', backgroundColor: '#f1f1f1', bпорядок: '1px solid #ccc', заполнение: '20px', textAlign: 'лево' }); функция showПодсказка(infoсписок, x, y) { всплывающее окно.innerHTML = ''; всплывающее окно.ид = 'всплывающее окно'; всплывающее окно.стиль.лево = x + 'px'; всплывающее окно.стиль.верх = y + 'px'; const heading = документ.createElement('h4'); heading.textContent = '任务信息'; heading.стиль.отступ = '0px'; всплывающее окно.appendChild(heading); const keys = { имя: '名称', planFinishкалендарь: '计划开始', planStartкалендарь: '计划结束' }; для (const key в infoсписок) { if (!keys[key]) { continue; } const информация = infoсписок[key]; const info1 = документ.createElement('p'); info1.textContent = keys[key] + ': ' + информация; всплывающее окно.appendChild(info1); } // 将弹出框添加到文档主体中 документ.body.appendChild(всплывающее окно); } функция hideПодсказка() { if (документ.body.contains(всплывающее окно)) { документ.body.removeChild(всплывающее окно); } } const пользовательскиймакет = args => { const { ширина, высота, taskRecord } = args; const контейнер = новый втаблицагантт.VRender.группа({ ширина, высота, cornerRadius: 10, заполнить: taskRecord?.timeConflict ? '#f0943a' : taskRecord?.keyNode ? '#446eeb' : taskRecord?.confirmed ? '#63bb5c' : '#ebeced', display: 'flex', flexDirection: 'строка', flexWrap: 'nowrap', alignItems: 'центр', boundsPadding: 10 }); if (taskRecord?.timeConflict) { const reportиконка = новый втаблицагантт.VRender.Imвозраст({ ширина: 20, высота: 20, imвозраст: report }); контейнер.add(reportиконка); } if (taskRecord?.keyNode) { const reportиконка = новый втаблицагантт.VRender.Imвозраст({ ширина: 20, высота: 20, imвозраст: flag }); контейнер.add(reportиконка); } const имя = новый втаблицагантт.VRender.текст({ текст: taskRecord.имя, заполнить: taskRecord?.keyNode ? '#fff' : '#0f2819', suffixPosition: 'конец', fontSize: 14, boundsPadding: 10 }); контейнер.add(имя); контейнер.addсобытиесписокener('mouseenter', событие => { const контейнер = документ.getElementById(CONTAINER_ID); const containerRect = контейнер.getBoundingClientRect(); const targetY = событие.target.globalAABBBounds.y2; const targetX = событие.target.globalAABBBounds.x1; showПодсказка(taskRecord, событие.client.x, targetY + containerRect.верх); }); контейнер.addсобытиесписокener('mouseleave', () => { hideПодсказка(); }); возврат { rootContainer: контейнер }; }; const records = [ { key: '0', check: { checked: false, отключить: true }, имя: 'FA账期关闭', planStartкалендарь: '2025-01-01 10:00:00', planFinishкалендарь: '2025-01-03 00:00:00', hierarchyState: 'развернуть', keyNode: false, timeConflict: false, confirmed: false, children: [ { key: '0,0', check: { checked: false, отключить: true }, имя: 'FA账期关闭', planStartкалендарь: '2025-01-02 13:30', planFinishкалендарь: '2025-01-02 15:00', hierarchyState: 'развернуть', keyNode: true, timeConflict: false, confirmed: false, children: [ { key: '0,0,0', check: { checked: false, отключить: true }, имя: '负责人', planStartкалендарь: '2025-01-02 13:30', planFinishкалендарь: '2025-01-02 15:00', keyNode: false, timeConflict: true, confirmed: false } ] } ] }, { key: '1', check: { checked: false, отключить: true }, имя: 'GL资金结账', planStartкалендарь: '2025-01-01 10:00:00', planFinishкалендарь: '2025-01-05 00:00:00', hierarchyState: 'развернуть', keyNode: false, timeConflict: false, confirmed: false, children: [ { key: '1,0', check: { checked: false, отключить: true }, имя: '第三方提现中转核对', planStartкалендарь: '2025-01-02 10:30', planFinishкалендарь: '2025-01-03 12:00', hierarchyState: 'развернуть', keyNode: false, timeConflict: false, confirmed: false, children: [ { key: '1,0,0', check: { checked: false, отключить: true }, имя: '负责人', planStartкалендарь: '2025-01-02 10:30', planFinishкалендарь: '2025-01-03 12:00', keyNode: false, timeConflict: false, confirmed: false } ] }, { key: '1,1', check: { checked: false, отключить: true }, имя: '红包提现流水入账', planStartкалендарь: '2025-01-03 10:30', planFinishкалендарь: '2025-01-03 12:00', hierarchyState: 'развернуть', keyNode: false, timeConflict: false, confirmed: false, children: [ { key: '1,1,0', check: { checked: false, отключить: true }, имя: '负责人', planStartкалендарь: '2025-01-03 10:30', planFinishкалендарь: '2025-01-03 12:00', keyNode: false, timeConflict: false, confirmed: false } ] }, { key: '1,2', check: { checked: false, отключить: true }, имя: '资金中转对平', planStartкалендарь: '2025-01-03 16:00', planFinishкалендарь: '2025-01-03 19:00', hierarchyState: 'развернуть', keyNode: false, timeConflict: false, confirmed: false, children: [ { key: '1,2,0', check: { checked: false, отключить: true }, имя: '负责人', planStartкалендарь: '2025-01-03 16:00', planFinishкалендарь: '2025-01-03 19:00', keyNode: false, timeConflict: false, confirmed: false } ] }, { key: '1,3', check: { checked: false, отключить: true }, имя: '投资组完成境内流水认款', planStartкалендарь: '2025-01-03 10:00', planFinishкалендарь: '2025-01-03 19:00', hierarchyState: 'развернуть', keyNode: false, timeConflict: false, confirmed: false, children: [ { key: '1,3,0', check: { checked: false, отключить: true }, имя: '负责人', planStartкалендарь: '2025-01-03 10:00', planFinishкалендарь: '2025-01-03 19:00', keyNode: false, timeConflict: false, confirmed: false } ] } ] } ]; const колонки = [ { headerType: 'флажок', //指定表头单元格显示为复选框 типЯчейки: 'флажок', //指定body单元格显示为复选框 поле: 'check', checked: false, ширина: 50 }, { поле: 'имя', заголовок: '任务', ширина: 220, tree: true, иконка: ({ таблица, колонка, строка }) => { const запись = таблица.getCellOriginRecord(колонка, строка); if (запись.keyNode) { возврат 'flag'; } }, стиль: ({ таблица, колонка, строка }) => { const запись = таблица.getCellOriginRecord(колонка, строка); возврат { // - 已确认-绿底；未确认-白底 bgColor: запись?.timeConflict ? '#f0943a' : запись.confirmed ? '#63bb5c' : undefined }; } }, { поле: 'planStartкалендарь', заголовок: '计划开始', ширина: 'авто' }, { поле: 'planFinishкалендарь', заголовок: '计划完成', ширина: 'авто' } ]; const опция = { overscrollBehavior: 'никто', records, taskсписоктаблица: { enableTreeNodeMerge: true, колонки, таблицаширина: 'авто', тема: втаблица.темаs.арко.extends({ // 表格外边框设置 frameStyle: { borderLineширина: 0, shadowBlur: 0 }, headerStyle: { навести: { cellBgColor: '#eef1f5' } }, bodyStyle: { bgColor: '#fff', навести: { cellBgColor: 'rgba(0,0,0,0.03)' } }, ПодсказкаStyle: { цвет: '#fff', bgColor: '#202328' } }), Подсказка: { isShowOverflowTextПодсказка: true }, меню: { contextменюItems: ['编辑'] }, frozenColCount: 1 }, frame: { outerFrameStyle: { borderLineширина: 1, borderColor: '#e1e4e8', cornerRadius: 0 }, verticalSplitLine: { lineColor: '#e1e4e8', lineширина: 1 }, horizontalSplitLine: { lineColor: '#e1e4e8', lineширина: 1 }, verticalSplitLineMoveable: true, verticalSplitLineHighlight: { lineColor: 'green', lineширина: 1 } }, grid: { verticalLine: { lineширина: 1, lineColor: '#e1e4e8' }, horizontalLine: { lineширина: 1, lineColor: '#e1e4e8' } }, headerRowвысота: 40, rowвысота: 40, taskBar: { startDateполе: 'planStartкалендарь', endDateполе: 'planFinishкалендарь', progressполе: 'progress', resizable: true, moveable: true, scheduleCreaтаблица: false, labelTextStyle: { fontFamily: 'Arial', fontSize: 14, textAlign: 'право', textOverflow: 'ellipsis', textBaseline: 'низ' }, barStyle: { ширина: 30, /** 任务条的圆角 */ cornerRadius: 10, /** 任务条的边框 */ borderLineширина: 0, /** 边框颜色 */ borderColor: 'black' }, hoverBarStyle: { /** 任务条的颜色 */ barOverlayColor: 'rgba(0,0,0,0.15)' }, selectedBarStyle: { /** 任务条的颜色 */ borderColor: '#000000', borderLineширина: 0 }, пользовательскиймакет }, timelineHeader: { verticalLine: { lineширина: 1, lineColor: '#e1e4e8' }, horizontalLine: { lineширина: 1, lineColor: '#e1e4e8' }, backgroundColor: '#EEF1F5', colширина: 40, scales: [ { unit: 'day', step: 1, startOfWeek: 'sunday', format(date) { const day = втаблицагантт.tools.formatDate(новый Date(date.startDate), 'yyyy-mm-dd'); возврат day; }, стиль: { fontSize: 16, fontWeight: 'normal' } }, { unit: 'hour', step: 1, стиль: { fontSize: 14, fontWeight: 'normal' } } ] }, markLine: [ { date: '2025-01-02 13:30:00', scrollToMarkLine: true, позиция: 'середина', стиль: { lineColor: 'red', lineширина: 1, lineDash: [5, 5] } } ], scrollStyle: { scrollRailColor: 'RGBA(246,246,246,0.5)', видимый: 'scrolling', ширина: 6, scrollSliderCornerRadius: 2, scrollSliderColor: '#c0c0c0' } }; ганттInstance = новый втаблицагантт.гантт(документ.getElementById(CONTAINER_ID), опция); window['ганттInstance'] = ганттInstance; ``` 