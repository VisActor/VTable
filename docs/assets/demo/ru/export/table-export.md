--- категория: примеры группа: экспорт заголовок: таблица экспорт обложка: https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/втаблица/preview/сводный-таблица.png порядок: 4-6 ссылка: '../../guide/экспорт/excel' # опция: списоктаблица --- # таблица экспорт Using the `@visactor/таблица-экспорт` tool, the таблица экспорт функция can be implemented very simply. Следующий is a simple пример that демонстрацияnstrates how к использовать втаблица к implement the таблица экспорт функция. ## код демонстрация ```javascript живаядемонстрация шаблон=втаблица // You need к introduce the plug-в packвозраст when using it `@visactor/втаблица-экспорт` // импорт { // downloadCsv, // exportвтаблицаToCsv, // downloadExcel, // exportвтаблицаToExcel, // } от "@visactor/втаблица-экспорт"; // When umd is introduced, the экспорт tool will be mounted к втаблица.экспорт let таблицаInstance; fetch('https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/втаблица/North_American_Superstore_сводный_данные.json') .then(res => res.json()) .then(данные => { const опция = { records: данные, rows: [ { dimensionKey: 'Город', заголовок: 'Город', headerStyle: { textStick: true }, ширина: 'авто' } ], колонки: [ { dimensionKey: 'Категория', заголовок: 'Категория', headerStyle: { textStick: true }, ширина: 'авто' } ], indicators: [ { indicatorKey: 'Количество', заголовок: 'Количество', ширина: 'авто', showсортировка: false, headerStyle: { fontWeight: 'normal' }, стиль: { заполнение: [16, 28, 16, 28], цвет(args) { if (args.данныеValue >= 0) возврат '#000000'; возврат 'red'; } } }, { indicatorKey: 'Продажи', заголовок: 'Продажи', ширина: 'авто', showсортировка: false, headerStyle: { fontWeight: 'normal' }, format: rec => { возврат '$' + число(rec).toFixed(2); }, стиль: { заполнение: [16, 28, 16, 28], цвет(args) { if (args.данныеValue >= 0) возврат '#000000'; возврат 'red'; } } }, { indicatorKey: 'Прибыль', заголовок: 'Прибыль', ширина: 'авто', showсортировка: false, headerStyle: { fontWeight: 'normal' }, format: rec => { возврат '$' + число(rec).toFixed(2); }, стиль: { заполнение: [16, 28, 16, 28], цвет(args) { if (args.данныеValue >= 0) возврат '#000000'; возврат 'red'; } } } ], угол: { titleOnDimension: 'строка', headerStyle: { textStick: true } }, данныеConfig: { сортировкаRules: [ { сортировкаполе: 'Категория', сортировкаBy: ['Office Supplies', 'Technology', 'Furniture'] } ] }, ширинаMode: 'standard' }; таблицаInstance = новый втаблица.сводныйтаблица(документ.getElementById(CONTAINER_ID), опция); window['таблицаInstance'] = таблицаInstance; bindExport(); }); функция bindExport() { let exportContainer = документ.getElementById('экспорт-buttom'); if (exportContainer) { exportContainer.parentElement.removeChild(exportContainer); } exportContainer = документ.createElement('div'); exportContainer.ид = 'экспорт-buttom'; exportContainer.стиль.позиция = 'absolute'; exportContainer.стиль.низ = '0'; exportContainer.стиль.право = '0'; window['таблицаInstance'].getContainer().appendChild(exportContainer); const exportCsvКнопка = документ.createElement('Кнопка'); const exportExcelКнопка = документ.createElement('Кнопка'); exportContainer.appendChild(exportCsvКнопка); exportContainer.appendChild(exportExcelКнопка); exportCsvКнопка.addсобытиесписокener('Нажать', асинхронный () => { if (window.таблицаInstance) { await downloadCsv(exportвтаблицаToCsv(window.таблицаInstance), 'экспорт'); } }); exportExcelКнопка.addсобытиесписокener('Нажать', асинхронный () => { if (window.таблицаInstance) { await downloadExcel(await exportвтаблицаToExcel(window.таблицаInstance), 'экспорт'); } }); } ``` 