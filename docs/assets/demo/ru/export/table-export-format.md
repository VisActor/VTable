--- категория: примеры группа: экспорт заголовок: таблица экспорт (пользовательский экспорт) обложка: https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/втаблица/preview/флажок-демонстрация.png порядок: 4-6 ссылка: '../../guide/экспорт/excel' # опция: списоктаблица --- # таблица экспорт(пользовательский экспорт) по по умолчанию, when exporting, the текст или imвозраст inside the exported ячейка will be output к Excel. If you need к пользовательскийize the экспорт content, Вы можете set `formatExportOutput` к a функция, и the возврат значение из the функция is the exported строка. If the возврат значение is `undefined`, the по умолчанию экспорт logic will be processed. ## код демонстрация ```javascript живаядемонстрация шаблон=втаблица // You need к introduce the plug-в packвозраст when using it `@visactor/втаблица-экспорт` // импорт { // downloadCsv, // exportвтаблицаToCsv, // downloadExcel, // exportвтаблицаToExcel, // } от "@visactor/втаблица-экспорт"; // When umd is introduced, the экспорт tool will be mounted к втаблица.экспорт const records = [ { productимя: 'aaaa', price: 20, check: { текст: 'unchecked', checked: false, отключить: false } }, { productимя: 'bbbb', price: 18, check: { текст: 'checked', checked: true, отключить: false } }, { productимя: 'cccc', price: 16, check: { текст: 'отключить', checked: true, отключить: true } }, { productимя: 'cccc', price: 14, check: { текст: 'отключить', checked: false, отключить: true } }, { productимя: 'eeee', price: 12, check: { текст: 'checked', checked: false, отключить: false } }, { productимя: 'ffff', price: 10, check: { текст: 'checked', checked: false, отключить: false } }, { productимя: 'gggg', price: 10, check: { текст: 'checked', checked: false, отключить: false } } ]; const колонки = [ { поле: 'isCheck', заголовок: '', ширина: 60, headerType: 'флажок', типЯчейки: 'флажок' }, { поле: 'productимя', заголовок: 'productимя', ширина: 120 }, { поле: 'price', заголовок: 'флажок', ширина: 120, типЯчейки: 'флажок', отключить: true, checked: true }, { поле: 'check', заголовок: 'флажок', ширина: 120, типЯчейки: 'флажок' // отключить: true } ]; const опция = { records, колонки }; const таблицаInstance = новый втаблица.списоктаблица(документ.getElementById(CONTAINER_ID), опция); window.таблицаInstance = таблицаInstance; bindExport(); функция bindExport() { let exportContainer = документ.getElementById('экспорт-buttom'); if (exportContainer) { exportContainer.parentElement.removeChild(exportContainer); } exportContainer = документ.createElement('div'); exportContainer.ид = 'экспорт-buttom'; exportContainer.стиль.позиция = 'absolute'; exportContainer.стиль.низ = '0'; exportContainer.стиль.право = '0'; window['таблицаInstance'].getContainer().appendChild(exportContainer); const exportCsvКнопка = документ.createElement('Кнопка'); exportCsvКнопка.innerHTML = 'CSV-экспорт'; const exportExcelКнопка = документ.createElement('Кнопка'); exportExcelКнопка.innerHTML = 'Excel-экспорт'; exportContainer.appendChild(exportCsvКнопка); exportContainer.appendChild(exportExcelКнопка); exportCsvКнопка.addсобытиесписокener('Нажать', асинхронный () => { if (window.таблицаInstance) { await downloadCsv(exportвтаблицаToCsv(window.таблицаInstance), 'экспорт'); } }); exportExcelКнопка.addсобытиесписокener('Нажать', асинхронный () => { if (window.таблицаInstance) { await downloadExcel( await exportвтаблицаToExcel(window.таблицаInstance, { formatExportOutput: ({ типЯчейки, cellValue, таблица, колонка, строка }) => { if (типЯчейки === 'флажок') { возврат таблица.getCellCheckboxState(колонка, строка) ? 'true' : 'false'; } } }), 'экспорт' ); } }); } ``` 