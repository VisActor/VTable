# VTable Sheet ç»Ÿä¸€äº‹ä»¶ç³»ç»Ÿ - å®Œæ•´æ–¹æ¡ˆ

## ğŸ“Œ èƒŒæ™¯

ä¹‹å‰çš„å®ç°æœ‰ä¸¤å¥—äº‹ä»¶ç³»ç»Ÿï¼š

1. **WorkSheet çš„ EventTarget** - WorkSheet ç»§æ‰¿ EventTargetï¼Œè§¦å‘ WorkSheetEventType äº‹ä»¶
2. **VTableSheet çš„ onTableEvent** - é€šè¿‡ TableEventRelay ä¸­è½¬ VTable äº‹ä»¶

è¿™å¯¼è‡´ï¼š
- âŒ ä»£ç å¤æ‚ï¼Œæœ‰ä¸¤å¥—äº‹ä»¶æµ
- âŒ å†…éƒ¨ç»„ä»¶ï¼ˆEventManagerï¼‰ç›‘å¬ WorkSheet äº‹ä»¶
- âŒ å¤–éƒ¨ç”¨æˆ·ç›‘å¬ VTableSheet äº‹ä»¶
- âŒ ä¸­é—´å¤šäº†ä¸€å±‚åŒ…è£…ï¼ˆWorkSheet.fireï¼‰

## âœ¨ è§£å†³æ–¹æ¡ˆ

**åˆå¹¶ä¸ºä¸€å¥—ç»Ÿä¸€çš„äº‹ä»¶ç³»ç»Ÿ**

```
tableInstance â†’ TableEventRelay â†’ æ‰€æœ‰ç›‘å¬å™¨ï¼ˆå†…éƒ¨ + å¤–éƒ¨ï¼‰
```

### æ ¸å¿ƒåŸåˆ™

1. âœ… **ç§»é™¤ WorkSheet çš„ EventTarget** - WorkSheet ä¸å†ç»§æ‰¿ EventTarget
2. âœ… **ç»Ÿä¸€ä½¿ç”¨ onTableEvent** - å†…éƒ¨å’Œå¤–éƒ¨éƒ½ç”¨ `sheet.onTableEvent()`
3. âœ… **è‡ªåŠ¨é™„å¸¦ sheetKey** - æ‰€æœ‰äº‹ä»¶å›è°ƒéƒ½åŒ…å« `sheetKey` å‚æ•°
4. âœ… **å‡å°‘ä¸­é—´å±‚** - ç›´æ¥ä» tableInstance åˆ°ç›‘å¬å™¨

## ğŸ”§ å®ç°ç»†èŠ‚

### 1. WorkSheet ç±»æ”¹é€ 

#### ç§»é™¤çš„åŠŸèƒ½

```typescript
// âŒ ä¹‹å‰ï¼šç»§æ‰¿ EventTarget
export class WorkSheet extends EventTarget implements IWorkSheetAPI {
  constructor(sheet: VTableSheet, options: IWorkSheetOptions) {
    super(); // âŒ è°ƒç”¨ EventTarget æ„é€ å‡½æ•°
    // ...
  }
  
  handleCellSelected(event: any): void {
    this.fire(WorkSheetEventType.CELL_CLICK, event); // âŒ è§¦å‘äº‹ä»¶
  }
  
  on(eventName: string, handler: Function): this { // âŒ å¯¹å¤–æš´éœ²çš„ç›‘å¬æ–¹æ³•
    return super.on(eventName, handler);
  }
}
```

#### ç°åœ¨çš„å®ç°

```typescript
// âœ… ç°åœ¨ï¼šä¸ç»§æ‰¿ EventTarget
export class WorkSheet implements IWorkSheetAPI {
  constructor(sheet: VTableSheet, options: IWorkSheetOptions) {
    // âœ… ä¸å†è°ƒç”¨ super()
    // ...
  }
  
  handleCellSelected(event: any): void {
    // âœ… åªæ›´æ–°å†…éƒ¨çŠ¶æ€ï¼Œä¸è§¦å‘äº‹ä»¶
    this.selection = {
      startRow: event.row,
      startCol: event.col,
      endRow: event.row,
      endCol: event.col
    };
    // äº‹ä»¶ç”± TableEventRelay ç»Ÿä¸€å¤„ç†
  }
  
  // âœ… ä¸å†æœ‰ on() å’Œ fire() æ–¹æ³•
}
```

### 2. EventManager æ”¹é€ 

#### ä¹‹å‰çš„å®ç°

```typescript
// âŒ ç›‘å¬ WorkSheet äº‹ä»¶
export class EventManager {
  constructor(sheet: VTableSheet) {
    this.sheet = sheet;
    this.handleCellClickBind = this.handleCellClick.bind(this);
    // ...
  }
}

// åœ¨ VTableSheet åˆ›å»º WorkSheet æ—¶
sheet.on(WorkSheetEventType.CELL_CLICK, this.eventManager.handleCellClickBind);
sheet.on(WorkSheetEventType.CELL_VALUE_CHANGED, this.eventManager.handleCellValueChangedBind);
```

#### ç°åœ¨çš„å®ç°

```typescript
// âœ… ä½¿ç”¨ç»Ÿä¸€çš„ onTableEvent
export class EventManager {
  constructor(sheet: VTableSheet) {
    this.sheet = sheet;
    this.setupTableEventListeners();
  }
  
  private setupTableEventListeners(): void {
    // âœ… ç›´æ¥ç›‘å¬ VTableSheet çš„äº‹ä»¶
    this.sheet.onTableEvent('click_cell', (event) => {
      // å¤„ç†å†…éƒ¨é€»è¾‘
      if (!this.sheet.formulaManager.formulaWorkingOnCell) {
        this.sheet.formulaUIManager.updateFormulaBar();
      }
    });
    
    this.sheet.onTableEvent('change_cell_value', (event) => {
      // å¤„ç†å…¬å¼ç›¸å…³é€»è¾‘
      this.sheet.formulaManager.formulaRangeSelector.handleCellValueChanged(event);
    });
    
    this.sheet.onTableEvent('selected_changed', (event) => {
      // å¤„ç†å…¬å¼èŒƒå›´é€‰æ‹©
      this.sheet.formulaManager.formulaRangeSelector.handleSelectionChangedForRangeMode(event);
    });
  }
}
```

### 3. VTableSheet æ”¹é€ 

#### ä¹‹å‰çš„å®ç°

```typescript
createWorkSheetInstance(options: IWorkSheetOptions): WorkSheet {
  const sheet = new WorkSheet(this, options);
  
  // âŒ éœ€è¦æ‰‹åŠ¨æ³¨å†Œäº‹ä»¶ç›‘å¬
  sheet.on(WorkSheetEventType.CELL_CLICK, this.eventManager.handleCellClickBind);
  sheet.on(WorkSheetEventType.CELL_VALUE_CHANGED, this.eventManager.handleCellValueChangedBind);
  sheet.on(WorkSheetEventType.SELECTION_CHANGED, this.eventManager.handleSelectionChangedForRangeModeBind);
  sheet.on(WorkSheetEventType.SELECTION_END, this.eventManager.handleSelectionChangedForRangeModeBind);
  
  return sheet;
}
```

#### ç°åœ¨çš„å®ç°

```typescript
createWorkSheetInstance(options: IWorkSheetOptions): WorkSheet {
  const sheet = new WorkSheet(this, options);
  
  // âœ… ä¸éœ€è¦æ‰‹åŠ¨æ³¨å†Œï¼ŒEventManager å·²ç»åœ¨åˆå§‹åŒ–æ—¶é€šè¿‡ onTableEvent æ³¨å†Œäº†
  
  return sheet;
}
```

### 4. TableEventRelayï¼ˆä¿æŒä¸å˜ï¼‰

```typescript
export class TableEventRelay {
  private vtableSheet: VTableSheet;
  private eventListeners: Map<string, Array<(...args: any[]) => void>> = new Map();
  private sheetEventBindings: Map<string, Map<string, (...args: any[]) => void>> = new Map();

  /**
   * ç»‘å®š WorkSheet çš„ tableInstance äº‹ä»¶
   */
  bindSheetEvents(sheetKey: string, tableInstance: ListTable): void {
    const bindings = new Map<string, (...args: any[]) => void>();
    
    // ä¸ºæ‰€æœ‰ VTable äº‹ä»¶åˆ›å»ºåŒ…è£…å‡½æ•°
    Object.values(TABLE_EVENT_TYPE).forEach((eventType: string) => {
      const wrappedCallback = (...args: any[]) => {
        this._handleTableEvent(sheetKey, eventType, ...args);
      };
      
      tableInstance.on(eventType as any, wrappedCallback);
      bindings.set(eventType, wrappedCallback);
    });
    
    this.sheetEventBindings.set(sheetKey, bindings);
  }

  /**
   * å¤„ç† VTable äº‹ä»¶ï¼Œé™„å¸¦ sheetKey
   */
  private _handleTableEvent(sheetKey: string, originalEventType: string, ...args: any[]): void {
    const eventData = args[0] || {};
    const enrichedEvent = { ...eventData, sheetKey };
    
    // è§¦å‘æ‰€æœ‰æ³¨å†Œçš„ç›‘å¬å™¨
    const listeners = this.eventListeners.get(originalEventType) || [];
    listeners.forEach(callback => {
      callback(enrichedEvent);
    });
  }

  /**
   * ç”¨æˆ·æ³¨å†Œäº‹ä»¶ç›‘å¬
   */
  onTableEvent(type: string, callback: (...args: any[]) => void): void {
    if (!this.eventListeners.has(type)) {
      this.eventListeners.set(type, []);
    }
    this.eventListeners.get(type)!.push(callback);
  }
}
```

## ğŸ“Š æ¶æ„å¯¹æ¯”

### ä¹‹å‰çš„æ¶æ„ï¼ˆä¸¤å¥—ç³»ç»Ÿï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  VTableSheet                        â”‚
â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ EventManager â”‚         â”‚ TableEventRelay   â”‚    â”‚
â”‚  â”‚              â”‚         â”‚                   â”‚    â”‚
â”‚  â”‚ ç›‘å¬ WorkSheetâ”‚         â”‚ ç›‘å¬ tableInstanceâ”‚    â”‚
â”‚  â”‚ äº‹ä»¶         â”‚         â”‚ äº‹ä»¶              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â†‘                          â†‘               â”‚
â”‚         â”‚                          â”‚               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚               â”‚
â”‚  â”‚   WorkSheet     â”‚               â”‚               â”‚
â”‚  â”‚                 â”‚               â”‚               â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚               â”‚               â”‚
â”‚  â”‚ â”‚EventTarget  â”‚ â”‚               â”‚               â”‚
â”‚  â”‚ â”‚fire()       â”‚â†â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                               â”‚
â”‚  â”‚       â†‘         â”‚                               â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â” â”‚                               â”‚
â”‚  â”‚ â”‚tableInstanceâ”‚ â”‚                               â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é—®é¢˜ï¼š
1. ä¸¤å¥—äº‹ä»¶æµï¼ˆWorkSheet.fire + TableEventRelayï¼‰
2. WorkSheet åŒ…è£…äº‹ä»¶åå†è§¦å‘
3. å†…éƒ¨ç»„ä»¶ç›‘å¬ WorkSheet äº‹ä»¶
4. å¤–éƒ¨ç”¨æˆ·ç›‘å¬ TableEventRelay äº‹ä»¶
```

### ç°åœ¨çš„æ¶æ„ï¼ˆä¸€å¥—ç³»ç»Ÿï¼‰âœ¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  VTableSheet                        â”‚
â”‚                                                     â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚              â”‚ TableEventRelay  â”‚                  â”‚
â”‚              â”‚                  â”‚                  â”‚
â”‚              â”‚ â€¢ å­˜å‚¨æ‰€æœ‰ç›‘å¬å™¨ â”‚                  â”‚
â”‚              â”‚ â€¢ è‡ªåŠ¨é™„å¸¦sheetKeyâ”‚                  â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                       â”‚                             â”‚
â”‚      ç»Ÿä¸€çš„äº‹ä»¶ APIï¼šonTableEvent()                 â”‚
â”‚                       â”‚                             â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚         â†“             â†“             â†“              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚EventMgr  â”‚  â”‚ç”¨æˆ·ä»£ç  â”‚  â”‚å…¶ä»–ç»„ä»¶ â”‚         â”‚
â”‚   â”‚(å†…éƒ¨)    â”‚  â”‚(å¤–éƒ¨)   â”‚  â”‚         â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚  â”‚   WorkSheet     â”‚                               â”‚
â”‚  â”‚                 â”‚                               â”‚
â”‚  â”‚ (ä¸å†ç»§æ‰¿       â”‚                               â”‚
â”‚  â”‚  EventTarget)   â”‚                               â”‚
â”‚  â”‚                 â”‚                               â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                               â”‚
â”‚  â”‚ â”‚tableInstanceâ”‚ â”‚                               â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚                               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚           â”‚                                         â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚                                  â†“                 â”‚
â”‚                      TableEventRelay               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¼˜åŠ¿ï¼š
1. âœ… åªæœ‰ä¸€å¥—äº‹ä»¶æµï¼ˆTableEventRelayï¼‰
2. âœ… WorkSheet ä¸å†åŒ…è£…äº‹ä»¶
3. âœ… å†…éƒ¨å’Œå¤–éƒ¨éƒ½ç”¨ onTableEvent()
4. âœ… å‡å°‘ä¸­é—´å±‚ï¼Œæ€§èƒ½æ›´å¥½
```

## ğŸ¯ ä½¿ç”¨æ–¹å¼

### å†…éƒ¨ç»„ä»¶ï¼ˆEventManagerï¼‰

```typescript
export class EventManager {
  private setupTableEventListeners(): void {
    // âœ… ä½¿ç”¨ç»Ÿä¸€çš„ API
    this.sheet.onTableEvent('click_cell', (event) => {
      // event.sheetKey è‡ªåŠ¨é™„å¸¦
      console.log(`Sheet ${event.sheetKey} è¢«ç‚¹å‡»`);
      
      // å¤„ç†å†…éƒ¨é€»è¾‘
      if (!this.sheet.formulaManager.formulaWorkingOnCell) {
        this.sheet.formulaUIManager.updateFormulaBar();
      }
    });
  }
}
```

### å¤–éƒ¨ç”¨æˆ·ä»£ç 

```typescript
const sheet = new VTableSheet(container, options);

// âœ… ä½¿ç”¨ç»Ÿä¸€çš„ API
sheet.onTableEvent('click_cell', (event) => {
  // event.sheetKey è‡ªåŠ¨é™„å¸¦
  console.log(`Sheet ${event.sheetKey} è¢«ç‚¹å‡»`);
  console.log(`ä½ç½®: [${event.row}, ${event.col}]`);
});

sheet.onTableEvent('change_cell_value', (event) => {
  console.log(`Sheet ${event.sheetKey} ç¼–è¾‘`);
  autoSave(event);
});
```

## ğŸ“ ä»£ç æ”¹åŠ¨æ€»ç»“

| æ–‡ä»¶ | æ”¹åŠ¨ | è¯´æ˜ |
|------|------|------|
| `WorkSheet.ts` | - ç§»é™¤ `extends EventTarget`<br>- ç§»é™¤ `super()` è°ƒç”¨<br>- ç§»é™¤æ‰€æœ‰ `this.fire()` è°ƒç”¨<br>- ç§»é™¤ `on()` å’Œ `fireEvent()` æ–¹æ³•<br>- ç§»é™¤æœªä½¿ç”¨çš„ import | WorkSheet ä¸å†æ˜¯äº‹ä»¶æº |
| `EventManager.ts` | - ç§»é™¤é¢„ç»‘å®šçš„äº‹ä»¶å¤„ç†æ–¹æ³•<br>- æ·»åŠ  `setupTableEventListeners()`<br>- æ”¹ç”¨ `this.sheet.onTableEvent()` | å†…éƒ¨ç»„ä»¶ä½¿ç”¨ç»Ÿä¸€ API |
| `VTableSheet.ts` | - ç§»é™¤åˆ›å»º WorkSheet åçš„äº‹ä»¶æ³¨å†Œä»£ç <br>- ç§»é™¤æœªä½¿ç”¨çš„ import | ç®€åŒ– WorkSheet åˆ›å»ºæµç¨‹ |
| `TableEventRelay.ts` | ä¿æŒä¸å˜ | æ ¸å¿ƒäº‹ä»¶ä¸­è½¬é€»è¾‘ä¸å˜ |

## âœ¨ æ ¸å¿ƒä¼˜åŠ¿

### 1. ç®€æ´æ€§

```typescript
// åªæœ‰ä¸€ä¸ª API
sheet.onTableEvent(type, callback);
sheet.offTableEvent(type, callback);
```

### 2. ç»Ÿä¸€æ€§

```typescript
// å†…éƒ¨å’Œå¤–éƒ¨ä½¿ç”¨ç›¸åŒçš„æ–¹å¼
// å†…éƒ¨ï¼ˆEventManagerï¼‰
this.sheet.onTableEvent('click_cell', handler);

// å¤–éƒ¨ï¼ˆç”¨æˆ·ä»£ç ï¼‰
sheet.onTableEvent('click_cell', handler);
```

### 3. çµæ´»æ€§

```typescript
// å¯ä»¥ç›‘å¬ä»»ä½• VTable äº‹ä»¶
sheet.onTableEvent('click_cell', handler);
sheet.onTableEvent('scroll', handler);
sheet.onTableEvent('after_render', handler);
```

### 4. æ€§èƒ½

```typescript
// å‡å°‘äº†ä¸­é—´å±‚
// ä¹‹å‰ï¼štableInstance â†’ WorkSheet.fire â†’ EventManager/TableEventRelay
// ç°åœ¨ï¼štableInstance â†’ TableEventRelay â†’ æ‰€æœ‰ç›‘å¬å™¨
```

### 5. å¯ç»´æŠ¤æ€§

```typescript
// åªéœ€è¦ç»´æŠ¤ä¸€å¥—äº‹ä»¶ç³»ç»Ÿ
// ä»£ç æ›´æ¸…æ™°ï¼Œé€»è¾‘æ›´ç®€å•
```

## ğŸ‰ æ€»ç»“

### é—®é¢˜

ä¹‹å‰æœ‰ä¸¤å¥—äº‹ä»¶ç³»ç»Ÿï¼š
- WorkSheet çš„ EventTargetï¼ˆå†…éƒ¨ä½¿ç”¨ï¼‰
- VTableSheet çš„ onTableEventï¼ˆå¤–éƒ¨ä½¿ç”¨ï¼‰

### è§£å†³æ–¹æ¡ˆ

**åˆå¹¶ä¸ºä¸€å¥—ç»Ÿä¸€çš„äº‹ä»¶ç³»ç»Ÿ**ï¼š
1. âœ… ç§»é™¤ WorkSheet çš„ EventTarget
2. âœ… ç»Ÿä¸€ä½¿ç”¨ VTableSheet çš„ onTableEvent
3. âœ… å†…éƒ¨å’Œå¤–éƒ¨éƒ½ç”¨åŒä¸€ä¸ª API
4. âœ… æ‰€æœ‰äº‹ä»¶è‡ªåŠ¨é™„å¸¦ sheetKey

### ç»“æœ

```typescript
// ç»Ÿä¸€ã€ç®€æ´ã€å¼ºå¤§
const sheet = new VTableSheet(container, options);

// ä¸€ä¸ª API æå®šæ‰€æœ‰äº‹ä»¶ç›‘å¬
sheet.onTableEvent('click_cell', (event) => {
  console.log(`Sheet ${event.sheetKey} è¢«ç‚¹å‡»`);
});

// å†…éƒ¨ç»„ä»¶ä¹Ÿç”¨åŒæ ·çš„æ–¹å¼
// å®Œç¾å…±å­˜ï¼Œäº’ä¸å¹²æ‰°
```

---

**ç»Ÿä¸€äº‹ä»¶ç³»ç»Ÿï¼Œè®©ä»£ç æ›´ç®€æ´ï¼** ğŸš€


